var Config;(function(d){d.getAssetsPath=function(){return"assets/"};d.getGfxPath=function(){return"assets/gfx/"};d.getSpriteSheetsPath=function(){return"assets/spritesheets/"};d.getFontsPath=function(){return"assets/fonts/"}})(Config||(Config={}));var Utils;
(function(d){var e=function(){function c(){}c.getRandomArbitrary=function(b,a){return Math.random()*(a-b)+b};c.getProportionalScale=function(b,a){return a>=b?b/a:a/b};c.getHighScoresTable=function(){for(var b=parseInt(localStorage["flappy.highscore.count"]),a="<table id='highscoreTable' class='centered'><thead><tr><th>Player</th><th>Score</th><th>Time</th></tr></thead>",c=0;c<b;c++)a+="<tbody><tr"+(0==c%2?"":" class='odd'")+">",a+="<th>"+(c+1)+"</th>",a+="<th>"+localStorage["flappy.highscore."+c+
".email"]+"</th>",a+="<td>"+localStorage["flappy.highscore."+c+".score"]+"</td>",a+="<td>"+localStorage["flappy.highscore."+c+".time"]+"</td>",a+="</tr></tbody>";return a+("<tfoot><th>Total</th><td colspan='2'>"+b+" Scores</td></tfoot></table>")};c.getRank=function(b){var a=localStorage["flappy.highscore.count"],c=0;null==a?localStorage["flappy.highscore.count"]=0:c=parseInt(a);a=parseInt(localStorage["flappy.highscore.count"]);if(0<a)for(var e=0;e<a;e++){var d=parseInt(localStorage["flappy.highscore."+
e+".score"]);if(b>=d){c=e;break}}return c+1};c.storeEmail=function(b,a){localStorage["flappy.highscore."+(a-1)+".email"]=b};c.addHighscoreEntrySorted=function(b,a){var c=this.getRank(b),e=parseInt(localStorage["flappy.highscore.count"]),d=c-1;if(d<e)for(var f=e-1;f>=d;f--)localStorage["flappy.highscore."+(f+1)+".email"]=localStorage["flappy.highscore."+f+".email"],localStorage["flappy.highscore."+(f+1)+".score"]=localStorage["flappy.highscore."+f+".score"],localStorage["flappy.highscore."+(f+1)+".time"]=
localStorage["flappy.highscore."+f+".time"];localStorage["flappy.highscore."+d+".email"]="unknown";localStorage["flappy.highscore."+d+".score"]=b;localStorage["flappy.highscore."+d+".time"]=a;localStorage["flappy.highscore.count"]=e+1;return c};c.toInt=function(b){return~~b};return c}();d.UtilFunctions=e})(Utils||(Utils={}));var StateDefs;(function(d){d=d.GameOverStages||(d.GameOverStages={});d[d.STAGE_NONE=0]="STAGE_NONE";d[d.STAGE_INIT=1]="STAGE_INIT";d[d.STAGE_HIGHSCORE_ENTRY=2]="STAGE_HIGHSCORE_ENTRY";d[d.STAGE_FINAL=3]="STAGE_FINAL"})(StateDefs||(StateDefs={}));(function(d){var e=function(){function c(b){this.game=b;this.setStartTime(this.game.time.time)}c.prototype.setStartTime=function(b){this.startTime=b};c.prototype.getStartTime=function(){return this.startTime};c.prototype.restart=function(){this.setStartTime(this.game.time.time)};c.prototype.getCurrentTimeIntSeconds=function(){return d.UtilFunctions.toInt(this.game.time.elapsedSecondsSince(this.startTime))};c.prototype.getCurrentTimeSeconds=function(){return this.game.time.elapsedSecondsSince(this.startTime)};
c.prototype.getCurrentTimeMS=function(){return this.game.time.elapsedSince(this.startTime)};c.prototype.getFormattedTime=function(){var b=this.getCurrentTimeIntSeconds(),a=d.UtilFunctions.toInt(b/3600);0<a&&(b-=3600*a);var c=d.UtilFunctions.toInt(b/60);0<c&&(b-=60*c);return(9<a?"":"0")+a+":"+(9<c?"":"0")+c+":"+(9<b?"":"0")+b};return c}();d.Timer=e})(Utils||(Utils={}));var __extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(d){var e=function(c){function b(a,b){var e=c.call(this,a)||this;e.setInterval(b);e.setIntervalCheckPoint(e.startTime);return e}__extends(b,c);b.prototype.reInit=function(){this.restart();this.setIntervalCheckPoint(this.startTime)};b.prototype.setInterval=function(a){this.interval=a};b.prototype.getInterval=function(){return this.interval};b.prototype.setIntervalCheckPoint=function(a){this.intervalCheckPoint=a};b.prototype.getIntervalCheckPoint=function(){return this.intervalCheckPoint};
b.prototype.checkInterval=function(){return this.game.time.elapsedSince(this.intervalCheckPoint)>=this.interval?(this.setIntervalCheckPoint(this.game.time.time),!0):!1};return b}(d.Timer);d.IntervalTimer=e})(Utils||(Utils={}));__extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(d){var e=function(c){function b(a,b){var e=c.call(this,a)||this;e.setCountdown(b);return e}__extends(b,c);b.prototype.setCountdown=function(a){this.countdown=a};b.prototype.getCountdownValue=function(){var a=this.getCurrentTimeMS();return this.countdown-a};b.prototype.getCountdownValueSeconds=function(){var a=this.getCurrentTimeMS();return(this.countdown-a)/1E3};b.prototype.isRunning=function(){return this.getCurrentTimeMS()>=this.countdown?!1:!0};return b}(d.Timer);d.CountdownTimer=e})(Utils||
(Utils={}));__extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(d){var e=function(c){function b(a,b,e){a=c.call(this,a)||this;a.setMax(b);a.setMin(e);a.reInit();return a}__extends(b,c);b.prototype.setRndInterval=function(){this.rndInterval=d.UtilFunctions.getRandomArbitrary(this.min,this.max)};b.prototype.setIntervalCheckPoint=function(a){this.intervalCheckPoint=a};b.prototype.reInit=function(){this.restart();this.setIntervalCheckPoint(this.startTime);this.setRndInterval()};b.prototype.setMax=function(a){this.max=a};b.prototype.setMin=function(a){this.min=
a};b.prototype.getMax=function(){return this.max};b.prototype.getMin=function(){return this.min};b.prototype.checkInterval=function(){return this.game.time.elapsedSince(this.intervalCheckPoint)>=this.rndInterval?(this.reInit(),!0):!1};return b}(d.Timer);d.RandomIntervalTimer=e})(Utils||(Utils={}));var __extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}(),Sprites;
(function(d){var e=function(c){function b(a,b,e){var d=c.call(this,a,b,e,"BIRD_FLYING",0)||this;d.maxLeftSpeed=15;d.maxRightSpeed=10;d.game=a;d.animSpeed=10;d.outline=new Phaser.Sprite(d.game,b,e,"BIRD_OUTLINE",0);d.addKeys();d.effects=[d.game.add.audio("flap",.5,!1),d.game.add.audio("splat",1,!1)];d.currentXSpeed=0;d.game.physics.enable(d,Phaser.Physics.ARCADE);d.body.collideWorldBounds=!0;d.body.bounce.set(.4);d.body.setSize(74,66,12,10);d.game.physics.enable(d.outline,Phaser.Physics.ARCADE);d.outline.body.collideWorldBounds=
!0;d.outline.body.bounce.set(.4);d.outline.body.setSize(74,66,12,10);a=d.game.height/2-d.height/2;d.y=a;d.outline.y=a;d.Animate();d.game.add.existing(d);d.game.add.existing(d.outline);return d}__extends(b,c);b.prototype.addKeys=function(){this.FLY_BUTTON=this.game.input.keyboard.addKey(Phaser.Keyboard.X);this.LEFT_BUTTON=this.game.input.keyboard.addKey(Phaser.Keyboard.Y);this.RIGHT_BUTTON=this.game.input.keyboard.addKey(Phaser.Keyboard.C);this.FLY_BUTTON.onDown.add(d.Bird.prototype.flap,this)};b.prototype.removeKeys=
function(){this.game.input.keyboard.removeKey(this.FLY_BUTTON.keyCode);this.game.input.keyboard.removeKey(this.LEFT_BUTTON.keyCode);this.game.input.keyboard.removeKey(this.RIGHT_BUTTON.keyCode)};b.prototype.flap=function(){this.body.velocity.setTo(0,-70);this.outline.body.velocity.setTo(0,-70);this.effects[0].isPlaying||this.effects[0].play()};b.prototype.flyTo=function(a){this.x+=this.currentXSpeed*a;this.outline.x+=this.currentXSpeed*a};b.prototype.getOutline=function(){return this.outline};b.prototype.update=
function(){this.LEFT_BUTTON.isDown&&this.RIGHT_BUTTON.isDown?this.currentXSpeed=0:this.LEFT_BUTTON.isDown?(this.currentXSpeed=this.maxLeftSpeed,this.flyTo(-1)):this.RIGHT_BUTTON.isDown&&(this.currentXSpeed=this.maxRightSpeed,this.flyTo(1))};b.prototype.Animate=function(){this.animations.add("fly");this.animations.play("fly",this.animSpeed,!0);this.outline.animations.add("fly_outline");this.outline.animations.play("fly_outline",10,!0);this.animations.currentAnim.speed=this.animSpeed};b.prototype.die=
function(){this.effects[1].play();this.destroy()};b.MAX_SPEED=30;return b}(Phaser.Sprite);d.Bird=e})(Sprites||(Sprites={}));__extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(d){var e=function(c){function b(a,b,d,e){var f=c.call(this,a,b,d,"CROW_ENEMY",0)||this;f.animSpeed=10;f.maxFlySpeed=6E3;f.bird=e;f.effects=[f.game.add.audio("crow",.5,!1),f.game.add.audio("splat",1,!1),f.game.add.audio("hit",.5,!1)];f.anchor.setTo(.5,1);f.scale.x=-1;f.outline=f.game.add.sprite(b,d,"CROW_OUTLINE");f.outline.anchor.setTo(.5,1);f.outline.scale.x=-1;f.game.physics.enable(f,Phaser.Physics.ARCADE);f.game.physics.enable(f.outline,Phaser.Physics.ARCADE);f.body.moves=!1;f.outline.body.moves=
!1;f.body.setSize(72,60,-20,-20);f.rndGen=new Phaser.RandomDataGenerator([f.game.time.time]);f.game=a;f.minYDiff=.2*f.game.world.height;f.tweens=[];f.outlineTweens=[];f.randomizeProperties();f.id=f.rndGen.integerInRange(0,100);f.isHit=!1;f.startAttack();f.checkWorldBounds=!0;f.events.onEnterBounds.add(f.setDeathSentence,f);return f}__extends(b,c);b.prototype.setDeathSentence=function(){this.effects[0].play();this.events.onOutOfBounds.add(this.outOfBoundsDie,this)};b.prototype.randomizeProperties=
function(){this.rndGen.integerInRange(0,1);this.flyDestination=this.rndGen.realInRange(1/3*this.game.world.height,2/3*this.game.world.height);Math.abs(this.flyDestination-this.y)<this.minYDiff&&(this.flyDestination=this.flyDestination<this.y?this.flyDestination-this.minYDiff:this.flyDestination+this.minYDiff);this.flyDuration=this.rndGen.integerInRange(1E3,3E3);this.flySpeed=this.rndGen.integerInRange(3E3,this.maxFlySpeed)};b.prototype.getOutline=function(){return this.outline};b.prototype.getId=
function(){return this.id};b.prototype.hit=function(){if(!this.isHit){this.isHit=!0;this.game.tweens.remove(this.tweens[0]);this.game.tweens.remove(this.tweens[1]);this.game.tweens.remove(this.outlineTweens[0]);this.game.tweens.remove(this.outlineTweens[1]);var a=(this.maxFlySpeed-this.flySpeed)/10,b=this.rndGen.integerInRange(100,300);this.body.moves=!0;this.body.velocity.setTo(a,b);this.body.rotation=this.game.physics.arcade.angleToPointer(this)-Math.PI/2;this.outline.body.moves=!0;this.outline.body.velocity.setTo(a,
b);this.effects[2].play();this.onHitFunction()}};b.prototype.onHit=function(a){this.onHitFunction=a};b.prototype.update=function(){this.game.physics.arcade.overlap(this,this.bird,this.hit,null,this)};b.prototype.startAttack=function(){this.startAnimation(this,"fly_enemy");this.startAnimation(this.outline,"fly_enemy_outline");this.createTweens(this,this.tweens);this.createTweens(this.outline,this.outlineTweens)};b.prototype.startAnimation=function(a,b){a.animations.add(b);a.animations.play(b,this.animSpeed,
!0)};b.prototype.createTweens=function(a,b){b[0]=this.game.add.tween(a).to({x:-500},this.flySpeed,Phaser.Easing.Linear.None,!0);b[1]=this.game.add.tween(a).to({y:this.flyDestination},this.flyDuration,Phaser.Easing.Quadratic.InOut,!0,1E3,-1,!0)};b.prototype.outOfBoundsDie=function(){this.game.tweens.remove(this.tweens[0]);this.game.tweens.remove(this.tweens[1]);this.game.tweens.remove(this.outlineTweens[0]);this.game.tweens.remove(this.outlineTweens[1]);this.body.moves&&this.effects[1].play();this.outline.destroy();
this.destroy()};return b}(Phaser.Sprite);d.Enemy=e})(Sprites||(Sprites={}));var __extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}(),States;
(function(d){var e=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}__extends(b,c);b.prototype.create=function(){this.title=this.game.add.tileSprite(0,0,this.game.cache.getImage("title").width,this.game.cache.getImage("title").height,"title");this.title.scale.x=Utils.UtilFunctions.getProportionalScale(this.game.width,this.game.cache.getImage("title").width);this.title.scale.y=Utils.UtilFunctions.getProportionalScale(this.game.height,this.game.cache.getImage("title").height);
var a=this.game.add.bitmapText(0,0,"gamefont","Flappy Bird - Ergometer Edition",64);a.x=this.game.width/2-a.width/2;a.y=0+.1*this.game.height;this.cycleText=this.game.add.bitmapText(0,0,"gamefont","Start cycling to begin!",64);this.cycleText.x=this.game.width/2-this.cycleText.width/2;this.cycleText.y=0+.4*this.game.height;this.cycleText.alpha=0;this.game.add.tween(this.cycleText).to({alpha:1},2E3,Phaser.Easing.Linear.None,!0,0,1E3,!0);a=this.game.add.bitmapText(0,0,"gamefont","Created by\nAndreas Leibetseder",
24);a.x=this.game.width-a.width-36;a.y=0+.94*this.game.height;a.tint=1118481;a=this.game.add.bitmapText(0,0,"gamefont","GFX (opengameart.org):\nMoikMellah (Bird), Redshrike (Crow)\nTiny Speck (BG), extracted by jakegamer (orig. from public domain 'Glitch' game)\nSFX (freesound.org): Rick Hoppmann (Ambience), Gabriel Killhour (Ding), Robinhood76 (Screech)\njorickhoofd (Tick), AgentDD (Wings), J.Zazvurek (Fall), GameAudio (Loose), davidworksonline (Crow)",24);a.x=27;a.y=0+.875*this.game.height;a.tint=
1118481;this.START_BUTTON=this.game.input.keyboard.addKey(Phaser.Keyboard.X);this.START_BUTTON.onDown.add(b.prototype.buttonPressed,this);console.log("Local Storage supported: "+this.supports_html5_storage())};b.prototype.buttonPressed=function(){this.game.tweens.removeFrom(this.cycleText);this.game.state.start("GameScreenState")};b.prototype.supports_html5_storage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}};b.prototype.toggleFull=function(){this.game.scale.isFullScreen?
this.game.scale.stopFullScreen():this.game.scale.startFullScreen();this.game.scale.refresh()};return b}(Phaser.State);d.TitleScreenState=e})(States||(States={}));__extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(d){var e=function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a.playTimeString="00:00:00";a.scoreWord="SCORE";a.baseScore=1;a.multiplicatorColors=[4294967295,4280221440,49151,4288886254,4294934528];a.MAX_ENEMY_SPAWN_TIME=8E3;a.MIN_ENEMY_SPAWN_TIME=1500;a.enemyHit=function(){a.effects[2].play();a.enemyHitTimeout.setCountdown(2E3);a.enemyHitTimeout.restart()};return a}__extends(b,c);b.prototype.create=function(){this.rndGen=new Phaser.RandomDataGenerator([this.game.time.time]);
this.grayFilter=this.game.add.filter("Gray");this.music=this.game.add.audio("forest_ambience",1,!0);this.effects=[this.game.add.audio("tick",1,!1),this.game.add.audio("ding",.8,!1),this.game.add.audio("loose",.8,!1)];this.game.physics.startSystem(Phaser.Physics.ARCADE);this.game.physics.arcade.gravity.y=200;this.bgGroup=this.game.add.group();this.midGroup=this.game.add.group();this.frontGroup=this.game.add.group();this.bgTile0=this.game.add.tileSprite(0,0,this.game.stage.width,this.game.cache.getImage("bg_z-2").height,
"bg_z-2");this.bgTile0.scale.y=this.getBgTileScale(this.game.cache.getImage("bg_z-2").height);this.bgGroup.add(this.bgTile0);this.bgTile1=this.game.add.tileSprite(0,0,this.game.stage.width,this.game.cache.getImage("bg_z-1").height,"bg_z-1");this.bgTile1.scale.y=this.getBgTileScale(this.game.cache.getImage("bg_z-1").height);this.bgGroup.add(this.bgTile1);this.bird=new Sprites.Bird(this.game,200,this.game.height-this.game.height/2);this.midGroup.add(this.bird);this.bgTile2=this.game.add.tileSprite(0,
0,this.game.stage.width,this.game.cache.getImage("bg_z0").height,"bg_z0");this.bgTile2.scale.y=this.getBgTileScale(this.game.cache.getImage("bg_z0").height);this.frontGroup.add(this.bgTile2);this.frontGroup.add(this.bird.getOutline());var a=this.game.width-310;this.game.add.bitmapText(a+5,20,"gamefont","Time",32);this.playTimeText=this.game.add.bitmapText(a+150,20,"gamefont",this.playTimeString,32);this.score=0;this.resetScoreHelperVars();this.scoreIndicatorText=this.game.add.bitmapText(a+5,52,"gamefont",
" ",32);this.scoreMultiplicatorText=this.game.add.bitmapText(a+105,52,"gamefont","x"+this.scoreMultiplicator,32);this.scoreText=this.game.add.bitmapText(a+150,52,"gamefont",""+this.score,32);this.userInfo=this.game.add.bitmapText(0,0,"gamefont","",64);this.userInfo.x=this.game.width/2-(this.userInfo.width+150);this.userInfo.y=this.game.height/2-this.userInfo.height;a=this.game.add.graphics(a-4,10);a.lineStyle(5,16777215,1);a.drawRect(0,0,290,80);this.startTime=this.game.time.time;this.scoreLettersTimer=
new Utils.IntervalTimer(this.game,2E3);this.scoreTimer=new Utils.IntervalTimer(this.game,1300);this.gameTimeCountDown=new Utils.CountdownTimer(this.game,3E5);this.enemySpawnTimer=new Utils.RandomIntervalTimer(this.game,this.MAX_ENEMY_SPAWN_TIME,4E3);this.enemyHitTimeout=new Utils.CountdownTimer(this.game,0);this.gameAdjustTimer=new Utils.CountdownTimer(this.game,3E4);this.music.play()};b.prototype.resetScoreHelperVars=function(){this.numScoreLetters=this.scoreMultiplicator=0;this.maxScoreCountdown=
null};b.prototype.adjustDifficulty=function(){console.log("Adjusting Game Difficulty!");var a=.8*this.enemySpawnTimer.getMax(),b=.8*this.enemySpawnTimer.getMin(),b=b<this.MIN_ENEMY_SPAWN_TIME?this.MIN_ENEMY_SPAWN_TIME:b;this.enemySpawnTimer.setMax(a<b?b:a);this.enemySpawnTimer.setMin(b);this.enemySpawnTimer.reInit();this.gameAdjustTimer.restart()};b.prototype.generateEnemy=function(){var a=this.rndGen.realInRange(1/3-.1,2/3+.1),a=new Sprites.Enemy(this.game,this.game.width+500,this.game.height*a-
100,this.bird);a.onHit(this.enemyHit);this.midGroup.add(a);this.frontGroup.add(a.getOutline())};b.prototype.removeTween=function(a){this.game.tweens.removeFrom(a)};b.prototype.getBgTileScale=function(a){var b=this.game.height;return a>=b?b/a:a/b};b.prototype.update=function(){this.enemySpawnTimer.checkInterval()&&this.generateEnemy();this.calcScore();this.updateScoreDisplay();this.gameAdjustTimer.isRunning()||this.adjustDifficulty();this.bird.body.bottom!=this.game.world.bounds.bottom&&this.gameTimeCountDown.isRunning()?
(this.bgTile0.tilePosition.x-=4,this.bgTile1.tilePosition.x-=5,this.bgTile2.tilePosition.x-=6,this.updateTimer()):this.deathHandler()};b.prototype.calcScore=function(){var a=this.bird.top+this.bird.height/2;a>2/3*this.game.height||a<1/3*this.game.height||this.enemyHitTimeout.isRunning()?(this.game.stage.filters=[this.grayFilter],this.enemyHitTimeout.isRunning()?(a=""+this.enemyHitTimeout.getCountdownValueSeconds(),this.userInfo.setText(a)):(a=a>2/3*this.game.height?"Speed Up!":"Slow Down!",this.userInfo.text!=
a&&this.userInfo.setText(" "),this.displayUserInfo(a)),this.resetScoreHelperVars(),this.scoreLettersTimer.reInit(),this.scoreTimer.checkInterval()&&(this.score+=this.baseScore/2)):(this.game.stage.filters=null,this.hideUserInfo(),0==this.scoreMultiplicator&&(this.scoreMultiplicator=1,this.playScoreTween(),this.effects[1].play()),this.scoreLettersTimer.checkInterval()&&this.scoreMultiplicator<this.multiplicatorColors.length?this.numScoreLetters<this.multiplicatorColors.length-1?(this.stopScoreTween(null),
this.numScoreLetters++,this.effects[0].play()):(this.numScoreLetters=0,this.scoreMultiplicator++,this.playScoreTween(),this.effects[1].play()):this.scoreMultiplicator==this.multiplicatorColors.length&&(null==this.maxScoreCountdown?this.maxScoreCountdown=new Utils.CountdownTimer(this.game,3E3):this.stopScoreTween(this.maxScoreCountdown)),this.scoreTimer.checkInterval()&&(this.score+=this.baseScore*this.scoreMultiplicator))};b.prototype.displayUserInfo=function(a){" "==this.userInfo.text&&(this.effects[2].play(),
this.userInfo.setText(a),this.userInfo.alpha=0,this.game.add.tween(this.userInfo).to({alpha:1},400,Phaser.Easing.Linear.None,!0,0,150,!0))};b.prototype.hideUserInfo=function(){this.userInfo.setText("");this.userInfo.alpha=1;this.game.tweens.removeFrom(this.userInfo)};b.prototype.playScoreTween=function(){this.scoreIndicatorText.alpha=0;this.scoreMultiplicatorText.alpha=0;this.scoreText.alpha=0;this.game.add.tween(this.scoreIndicatorText).to({alpha:1},300,Phaser.Easing.Linear.None,!0,0,150,!0);this.game.add.tween(this.scoreMultiplicatorText).to({alpha:1},
300,Phaser.Easing.Linear.None,!0,0,150,!0);this.game.add.tween(this.scoreText).to({alpha:1},300,Phaser.Easing.Linear.None,!0,0,150,!0)};b.prototype.stopScoreTween=function(a){null!==a&&a.isRunning()||(this.scoreIndicatorText.alpha=1,this.scoreMultiplicatorText.alpha=1,this.scoreText.alpha=1,this.game.tweens.removeFrom(this.scoreIndicatorText),this.game.tweens.removeFrom(this.scoreMultiplicatorText),this.game.tweens.removeFrom(this.scoreText))};b.prototype.updateScoreDisplay=function(){this.scoreText.setText(""+
this.toInt(this.score));var a=this.scoreMultiplicator-1,b=0==this.numScoreLetters?this.scoreWord:this.scoreWord.substring(0,this.numScoreLetters);this.scoreIndicatorText.setText(b+" ");this.scoreMultiplicatorText.setText("x"+this.scoreMultiplicator);this.scoreText.tint=this.multiplicatorColors[a];this.scoreIndicatorText.tint=0==this.numScoreLetters?this.multiplicatorColors[a]:this.multiplicatorColors[a+1];this.scoreMultiplicatorText.tint=this.multiplicatorColors[a]};b.prototype.deathHandler=function(){this.playTimeText.setText("DEATH");
this.game.stage.filters=null;var a=this.toInt(this.score),b=this.getFormattedTime(this.toInt(this.game.time.elapsedSecondsSince(this.startTime)));this.game.state.states.GameOverScreenState.setTotalTime(b);this.game.state.states.GameOverScreenState.setScore(a);this.sound.stopAll();this.bird.removeKeys();this.bird.die();this.game.state.start("GameOverScreenState")};b.prototype.updateTimer=function(){var a=this.toInt(this.gameTimeCountDown.getCountdownValueSeconds());this.playTimeString=this.getFormattedTime(a);
this.playTimeText.setText(this.playTimeString)};b.prototype.getFormattedTime=function(a){var b=this.toInt(a/3600);0<b&&(a-=3600*b);var c=this.toInt(a/60);0<c&&(a-=60*c);return(9<b?"":"0")+b+":"+(9<c?"":"0")+c+":"+(9<a?"":"0")+a};b.prototype.toInt=function(a){return~~a};return b}(Phaser.State);d.GameScreenState=e})(States||(States={}));__extends=this&&this.__extends||function(){var d=function(e,c){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return d(e,c)};return function(e,c){function b(){this.constructor=e}d(e,c);e.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}();
(function(d){var e=function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a.screenState=StateDefs.GameOverStages.STAGE_NONE;a.totalTime="00:00:00";a.score=0;a.rank=0;a.email="";a.waitTime=3;return a}__extends(b,c);b.prototype.setTotalTime=function(a){this.totalTime=a};b.prototype.setScore=function(a){this.score=a};b.prototype.setRank=function(a){this.rank=a};b.prototype.create=function(){this.screenState=StateDefs.GameOverStages.STAGE_INIT;this.rank=Utils.UtilFunctions.addHighscoreEntrySorted(this.score,
this.totalTime);document.getElementById("score").innerHTML="Score: "+this.score;document.getElementById("rank").innerHTML="Rank: "+this.rank;var a=this.game.add.bitmapText(0,0,"gamefont","Game Over!",64);a.x=this.game.width/2-a.width/2;a.y=0+.1*this.game.height;a.tint=16711680;a=this.game.add.bitmapText(0,0,"gamefont","Your Score: "+this.score+" (Rank: "+this.rank+")\nPlaytime: "+this.totalTime,64);a.x=this.game.width/2-a.width/2;a.y=0+.4*this.game.height;a.tint=16711680;this.retryText=this.game.add.bitmapText(0,
0,"gamefont","Continue cycling to retry...",64);this.retryText.x=this.game.width/2-this.retryText.width/2;this.retryText.y=0+.8*this.game.height;this.retryText.tint=16711680;this.retryText.alpha=0;this.game.add.tween(this.retryText).to({alpha:1},2E3,Phaser.Easing.Linear.None,!0,0,1E3,!0);this.gameOverTime=this.game.time.time;this.screenState=StateDefs.GameOverStages.STAGE_HIGHSCORE_ENTRY;this.toggleOverlay()};b.prototype.update=function(){switch(this.screenState){case StateDefs.GameOverStages.STAGE_HIGHSCORE_ENTRY:this.updateHighScoreEntry();
break;case StateDefs.GameOverStages.STAGE_FINAL:this.updateFinal()}};b.prototype.updateHighScoreEntry=function(){this.email&&(Utils.UtilFunctions.storeEmail(this.email,this.rank),this.email="",this.gameOverTime=this.game.time.time,this.screenState=StateDefs.GameOverStages.STAGE_FINAL)};b.prototype.updateFinal=function(){this.toInt(this.game.time.elapsedSecondsSince(this.gameOverTime))>=this.waitTime&&(this.START_BUTTON=this.game.input.keyboard.addKey(Phaser.Keyboard.X),this.START_BUTTON.onDown.add(b.prototype.buttonPressed,
this))};b.prototype.buttonPressed=function(){this.game.tweens.removeFrom(this.retryText);this.game.state.start("GameScreenState")};b.prototype.toggleOverlay=function(){var a=document.getElementById("overlay");a.style.visibility="visible"==a.style.visibility?"hidden":"visible";document.forms.emailForm.email.focus()};b.prototype.setEmail=function(){var a=document.forms.emailForm;if(this.email=a.email.value)a.reset(),this.toggleOverlay()};b.prototype.toInt=function(a){return~~a};return b}(Phaser.State);
d.GameOverScreenState=e})(States||(States={}));var SimpleFlappyBird=function(){function d(d,c){4E3<d&&(d=4E3);1153<c&&(c=1153);this.game=new Phaser.Game(d,c,Phaser.AUTO,"content",{create:this.create,preload:this.preload})}d.prototype.preload=function(){var d=this.game.add.text(10,10,"Loading...",{font:"48px Arial",fill:"#ff0000",textAlign:"center"});d.anchor.set(.5,.5);d.position.set(this.game.width/2,this.game.height/2);d=Config.getFontsPath();this.game.load.bitmapFont("gamefont",d+"nokia.png",d+"nokia.xml");d=Config.getGfxPath();this.game.load.image("bg_z-2",
d+"bg/z-2.png");this.game.load.image("bg_z-1",d+"bg/z-1.png");this.game.load.image("bg_z0",d+"bg/z0.png");this.game.load.image("title",d+"title.png");this.game.load.image("cc",d+"by-nc-sa.jpg");d=Config.getSpriteSheetsPath();this.game.load.atlasJSONHash("BIRD_FLYING",d+"bird.png",d+"bird_flying.json");this.game.load.atlasJSONHash("BIRD_OUTLINE",d+"bird_outline.png",d+"bird_outline.json");this.game.load.atlasJSONHash("CROW_ENEMY",d+"crow.png",d+"crow.json");this.game.load.atlasJSONHash("CROW_OUTLINE",
d+"crow_outline.png",d+"crow_outline.json");this.game.load.script("grayfilter","phaserLib/Gray.js");this.game.load.audio("forest_ambience","assets/sound/Forest_Ambience.mp3");this.game.load.audio("flap","assets/sound/bird_flap.mp3");this.game.load.audio("splat","assets/sound/groundhit.mp3");this.game.load.audio("crow","assets/sound/crow.wav");this.game.load.audio("tick","assets/sound/tick.mp3");this.game.load.audio("ding","assets/sound/ding.mp3");this.game.load.audio("loose","assets/sound/loose.mp3");
this.game.load.audio("hit","assets/sound/groan.wav")};d.prototype.create=function(){this.game.state.add("TitleScreenState",States.TitleScreenState,!0);this.game.state.add("GameScreenState",States.GameScreenState,!1);this.game.state.add("GameOverScreenState",States.GameOverScreenState,!1);this.game.scale.scaleMode=Phaser.ScaleManager.NO_SCALE};d.prototype.getGame=function(){return this.game};return d}(),simpleflappy;window.onload=function(){simpleflappy=new SimpleFlappyBird(window.innerWidth,window.innerHeight)};
var resizeId;window.onresize=function(d){clearTimeout(resizeId);resizeId=setTimeout(finishedResize,500)};function finishedResize(){location.reload()}function setEmail(){simpleflappy.getGame().state.states.GameOverScreenState.setEmail();return!1};
